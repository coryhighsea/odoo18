<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="ai_agent.AIAgentSystray">
        <div class="o_systray_ai_agent">
            <button t-on-click="toggleChat" class="ai-agent-systray-btn">
                <i class="fa fa-robot"/> AI
            </button>
            <div t-if="state.isOpen" class="ai-agent-chat-window">
                <div class="ai-agent-chat-messages" t-ref="chatContainer">
                    <t t-foreach="state.messages" t-as="msg" t-key="msg">
                        <div t-att-class="'ai-agent-message ' + (msg.isUser ? 'user' : 'bot')">
                            <t t-esc="msg.content"/>
                        </div>
                    </t>
                </div>
                <div class="ai-agent-chat-input">
                    <textarea
                        t-model="state.inputMessage"
                        t-on-keydown="handleKeyPress"
                        placeholder="Type your message..."
                        rows="1"
                        t-att-disabled="state.isLoading ? true : undefined"
                    />
                    <button t-on-click="sendMessage" t-att-disabled="state.isLoading || !state.inputMessage.trim()" class="ai-agent-send-btn">
                        <i class="fa fa-paper-plane"/>
                    </button>
                </div>
            </div>
        </div>
    </t>
</templates>